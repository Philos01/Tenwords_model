# Ten Words Model

????????????????`unsloth`????`lora`???????????????`Qwen2.5-7B`??????[DeepSeekMath](https://arxiv.org/abs/2402.03300)????`GRPO`????????`unsloth`????`triton`????`win`??????????????`linux`??????

## ????
```bash
Ubuntu 20.04
torch 2.6.0
cuda 11.8
python 3.10
```
?????????`Pytorch(Cuda)`????

## Step1: ????
```bash
pip install unsloth 
pip install trl 
pip install nltk 
pip install GPUtil 
pip install re
# ???????????
pip install <package> -i https://pypi.tuna.tsinghua.edu.cn/simple
??nltk??????????punkt????????punk_tab,????????????Python Console?????????????.py??????
import nltk
nltk.download('punk')
nltk.download('punkt_tab')
???????????????????????????????????????package_download.py???????
```

## Step2: ????
??????????????????????????????????????`Prompts`???

```bash
my_prompts = [
    {"prompt": "Describe yourself using exactly ten words only."},
    # ??
    # ??
    # ??
]
```
????????????`Prompts`??????????2000???????????????????????????????????????????`Prompt`?

## Step3: ????
???????`lora`?????????????????????????`lora`?????????

????????`Qwen2.5-Coder-7B-Instruct`?????????????[Qwen2.5-Coder-7B-Instruct](https://huggingface.co/Qwen/Qwen2.5-Coder-7B-Instruct/tree/main)

```bash
from unsloth import FastLanguageModel

model_name = "/home/philos/PycharmProjects/PythonProject/Qwen2.5-Coder-7B-Instruct"
model, tokenizer = FastLanguageModel.from_pretrained(
    model_name=model_name,
    max_seq_length=2048,
    dtype=torch.bfloat16, 
    load_in_4bit=True,
    device_map="auto"
)
```

??????????????????????`lora_10words_v2`??????????`test.py`??????

```bash
import torch
from unsloth import FastLanguageModel

model_10words, tokenizer_10words = FastLanguageModel.from_pretrained(
    "lora_10words_v2",
    max_seq_length=2048,
    dtype=torch.bfloat16,
    load_in_4bit=True,
    device_map="auto",
)
FastLanguageModel.for_inference(model_10words)

prompt = "Describe the universe in exactly ten words."
inputs = tokenizer_10words.apply_chat_template(
    [{"role": "user", "content": prompt}],
    tokenize=True,
    add_generation_prompt=True,
    return_tensors="pt"
).to("cuda")

outputs = model_10words.generate(
    input_ids=inputs,
    max_new_tokens=20,
    temperature=0.9,
    top_p=0.95,
    repetition_penalty=1.1,
    do_sample=True,
    pad_token_id=tokenizer_10words.eos_token_id,
)

print(tokenizer_10words.decode(outputs[0]))
```

### ????
```
<|im_start|>system
You are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>
<|im_start|>user
Describe the universe in exactly ten words.<|im_end|>
<|im_start|>assistant
The universe is vast, containing stars, planets, and dark matter.<|im_end|>
```

????????????????????????????????????????????????????????

???????????????????????????????????????~
